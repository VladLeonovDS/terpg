# Workdir Roguelike

Терминальный рогалик на Java 17, где враги — файлы и каталоги, а урон наносится через преобразование представления их HP.

## Особенности
- Детерминированный забег по seed: одинаковый seed + snapshot дают одинаковый результат.
- Режимы запуска: `sandbox` (виртуальная карта), `readonlyscan` (сканирование метаданных реальной директории без записи) и `demo` (готовый snapshot).
- Боёвка через «утилиты»: `baseconv`, `fmt`, `sanitize`, `hash`, `grep`, `sed`, `determinism`, `entropy`.
- Визуализация в ASCII без мерцания; управление WASD + `u` для утилит, `q` для выхода.
- Сохранённые «снимки» уровней в `src/main/resources/snapshots/`.

## Сборка и запуск
Требуется Java 17+ и Maven.

```bash
mvn -q package
java -jar target/workdir-roguelike-0.1.0-shaded.jar --seed=12345 --mode=demo
```

Полезные параметры:
- `--seed=<число>` — фиксирует генерацию.
- `--mode=sandbox|readonlyscan|demo` — выбирает источник карты.
- `--snapshot=<путь>` — JSON-снимок уровня или директория для `readonlyscan`.

## Игровой цикл
1. Перемещайтесь по сетке (`WASD`).
2. Сталкивайтесь с врагами-файлами и запускайте утилиты (`u` → цифра).
3. Утилиты меняют основание/формат/энтропию HP противника; базовая атака добивает.
4. Энергия восстанавливается по 2 за ход; следите за щитом и HP.

## Безопасность
- По умолчанию (sandbox/demo) игра не обращается к реальной ФС.
- В режиме `readonlyscan` читаются только имена/типы узлов; записи/удаления нет.

## Тесты
Запуск unit и детерминированного headless-теста:

```bash
mvn -q test
```

## CI/CD
В репозитории есть GitHub Actions (`.github/workflows/ci.yml`):
- проверка кода `mvn test`;
- сборка fat-jar через shade;
- загрузка jar как артефакта.

## Структура проекта
- `src/main/java/org/terpg/workdir` — ядро игры, утилиты, генератор уровней.
- `src/main/resources/snapshots` — демо-снимки.
- `src/test/java/org/terpg/workdir` — unit и детерминизм-тесты.
